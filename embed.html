<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Scramjet Embed</title>
    <style>
      html, body, iframe {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        background: #121212;
        color: white;
        border: none;
      }
    </style>
    <script type="module">
      import { ScramjetController } from "/scram/scramjet.client.js";

      const scramjet = new ScramjetController({
        files: {
          wasm: "/scram/scramjet.wasm.wasm",
          worker: "/scram/scramjet.worker.js",
          client: "/scram/scramjet.client.js",
          shared: "/scram/scramjet.shared.js",
          sync: "/scram/scramjet.sync.js",
        },
      });

      await scramjet.init();
      navigator.serviceWorker.register("./sw.js").catch(() => {});

      const url = decodeURIComponent(location.hash.slice(1));
      if (!url || !url.startsWith("http")) {
        document.body.innerHTML = "<h1 style='text-align:center;padding-top:2em;'>Invalid or missing URL hash</h1>";
      } else {
        const frame = scramjet.createFrame();
        await frame.go(url);
        document.body.appendChild(frame.frame);
      }
    </script>
  </head>
  <body></body>
</html>
