<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://vjs.zencdn.net/7.14.3/video-js.css" />
    <link rel="stylesheet" href="/styles/defaults.css" />
    <style>
      .options,.selection{position:fixed;left:10px}.option,.selection{cursor:pointer;transition:.15s}.option,.options,.selection{transition:.15s}body{margin:0;height:100vh;overflow:hidden;position:relative;font-family:Inter,sans-serif;background-color:#000}.video-js{width:100%;height:100%}.selection{top:10px;z-index:1000;background:rgba(70,102,156,.7);border-radius:10px;height:35px;user-select:none;color:#fff;border:2px solid rgba(255,255,255,.25);display:flex;width:75px;justify-content:center;align-items:center}.selection:hover{opacity:.85}.options{display:none;top:54px;background:rgba(28,28,28,.9);border:2px solid rgba(255,255,255,.1);border-radius:10px;z-index:999;width:85px;opacity:0;transform:translateY(-5px)}.options.show{display:block;opacity:1;transform:translateY(0)}.option{padding:10px;color:rgba(255,255,255,.85);border-radius:10px}.option:hover{background:rgba(70,102,156,.2)}i{margin-right:5px}
    </style>
  </head>

  <body>
    <div class="selection" id="selection">
      <i class="fa-solid fa-cloud"></i> 1
    </div>
    <div class="options" id="options"></div>
    <video
      id="videoPlayer"
      class="video-js vjs-default-skin"
      controls
      autoplay
      muted
    ></video>

    <script src="https://vjs.zencdn.net/7.14.3/video.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/videojs-contrib-hls@5.16.0/dist/videojs-contrib-hls.min.js"></script>
    <script>
      const hash = window.location.hash.slice(1),
        servers = atob(hash)
          .split("|||")
          .filter((e) => "" !== e.trim()),
        selection = document.getElementById("selection"),
        optionsContainer = document.getElementById("options"),
        videoPlayer = videojs("videoPlayer");
      function playVideo(e) {
        videoPlayer.src({ src: e, type: "application/x-mpegURL" }),
          videoPlayer.play().catch((e) => {
            console.error("Error attempting to play:", e);
          });
      }
      servers.forEach((e, o) => {
        const t = document.createElement("div");
        (t.className = "option"),
          (t.innerHTML = `<i class="fa-solid fa-cloud"></i> ${o + 1}`),
          (t.dataset.value = e),
          t.addEventListener("click", function () {
            playVideo(this.dataset.value),
              (selection.innerHTML =
                '<i class="fa-solid fa-cloud"></i> ' + this.textContent),
              optionsContainer.classList.remove("show"),
              (optionsContainer.style.display = "none");
          }),
          optionsContainer.appendChild(t);
      }),
        selection.addEventListener("click", function () {
          optionsContainer.classList.contains("show")
            ? (optionsContainer.classList.remove("show"),
              selection.classList.remove("hover"),
              setTimeout(() => (optionsContainer.style.display = "none"), 150))
            : ((optionsContainer.style.display = "block"),
              selection.classList.add("hover"),
              setTimeout(() => optionsContainer.classList.add("show"), 10));
        }),
        document.addEventListener("click", function (e) {
          selection.contains(e.target) ||
            optionsContainer.contains(e.target) ||
            (optionsContainer.classList.remove("show"),
            (optionsContainer.style.display = "none"));
        }),
        servers.length > 0 &&
          (playVideo(servers[0]),
          (selection.innerHTML = '<i class="fa-solid fa-cloud"></i> 1'));
    </script>
  </body>
</html>
